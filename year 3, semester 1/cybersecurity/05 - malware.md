---
related to:
created: 2025-11-23, 18:32
updated: 2026-01-22T21:57
completed: false
---
>[!def] def by NIST-800-83
“a program that is inserted into a system, usually covertly, with the intent of compromising the confidentiality, integrity, or availability of the victim’s data, applications, or operating system or otherwise annoying or disrupting the victim”
## classification of malware
malware is classified broadly into two categories, based on two main factors:
- *how it spreads* to reach the desired targets.
- *the actions or payloads it performs* once a target is reached
*propagation mechanisms* include:
- *infection* of existing content by viruses, that is subsequently spread to other systems
- *exploit* of software vulnerabilities by worms or drive-by-downloads to allow the malware to replicate
- *social engineering* attacks that convince users to bypass security mechanisms to install trojans or to respond to phishing attacks
payload *actions performed* by malware once it reaches its target system can include:
- *corruption* of system or data files
- *theft of service*/make the systems a zombie agent of attack as part of a botnet
- *theft of information* from the system / keylogging
- *hididing its presence* on the system

it is also classified by its independency and replication ability

| classified as     | description                                                              | example              |
| :---------------- | :----------------------------------------------------------------------- | :------------------- |
| *needs a host*    | parasitic code that *requires another legitimate program* to attach to   | viruses              |
| *independent*     | self-contained programs that can *run on their own*                      | worms, trojans, bots |
| *non-replicating* | malware that *does not create copies* of itself or spread automatically. | trojans, spam e-mail |
| *replicating*     | malware that *self-replicates* and spreads to other systems.             | viruses, worms       |
## attacks
initially the development and deployment of malware required considerable technical skills by the authors, however the *toolkits* (also known as *crimeware*) created in the 1990s and 2000s greatly assisted in the development of malware
- they include a variety of propagation mechanisms, and variants that can be generated by attackers using these toolkits create a significant problem for those defending systems against them
another change is the nature of the attackers: from being individuals motivated to demonstrate their technical competence to their peers, to more organized and dangerous attack sources such as politically motivated hackerse, criminals or organizations that sell their services to companies and nations.
- huge underground economy for the sale of attack kits. great niche !
## APT
*advanced persistent threats* (*APT*) are well-resourced, persistent (over a long period of time) applications that differ from other types of attacks by their careful target selections (usually business or political) and stealthy intrusion efforts over extended periods
- *advanced*: APTs span a wide variety of intrusion technologies and malware, including the development of custom malware. while the individual components may not necessarily be technically advanced, they are chosen carefully to suit the selected target
- *persistent*: attacks happen over an exetended period of time, in order to maximize the chance of success against the target
- *threats*: they are threats to the selected targets because of the high commitment by organized, capable attrackers (so active attack, no automated attack tools)
the aim can be different, from theft of intellectual property to the physical disruption of an infrastructure
- once they have gained access to systems in the target organization, a further range of attack tools are used to maintain and extend their access
## viruses
a *virus* is a piece of software that infects programs.
- it modifies them to include a copy of the virus
- replicates and goes on to infect other programs or into
- easily spreads through network environments
a virus is dangerous because when attached to an executable program, it can do anything that the program is permitted to do.
it is comprised by:
- an *infection mechanism*: means by which a virus spreads or propagates
- a *trigger*(/*logic bomb*): an event that determines when the payload is activated/delivered
- a *payload*: what the virus does (besides spreading)
### virus phases

| phase                | description                                                                                  | characteristics                                          | more                                                                                                    |
| :------------------- | :------------------------------------------------------------------------------------------- | :------------------------------------------------------- | :------------------------------------------------------------------------------------------------------ |
| *dormant phase**     | virus is *idle*                                                                              | will eventually be activated by some event               | not all viruses have this stage                                                                         |
| *triggering phase**  | virus is *activated* to perform the function for which it was intended                       | can be caused by a variety of system events              | -                                                                                                       |
| *propagation phase** | virus places a *copy* of itself into other programs or into certain system areas on the disk | the copy may not be identical to the propagating version | each infected program will now contain a clone of the virus which will itself enter a propagation phase |
| *execution phase**   | *function* is performed                                                                      | may be harmless or damaging                              | -                                                                                                       |

>[!def] macro virus
“a virus that attaches itself to documents and uses the macro programming capabilities of the document’s application to execute and propagate”

macro viruses infect scripting code used to *support active content* in a variety of user document types !
they are threatening because:
- they are much easier to write or to modify than traditional executable viruses
- they are independent
- they infect documents and not code, and traditional file systems access controls are of limited use in preventing their spread
- they spread easily
>[!example] melissa macro virus pseudo-code
>```
>macro Document_Open 
>	disable Macro menu and some macro security features
>	if called from a user document
>		copy macro code into Normal template file 
>	else
>		copy macro code into user document being opened
>	end if 
>	if registry key "Melissa" not present
>		if Outlook is email client 
>			for first 50 addresses in address book
>				send email to that address with currently infected document attached
>			end for
>		end if
>		create registry key "Melissa"
>	end if
>	if minute in hour equals day of month
>		insert text into document being opened
>	end if
>end macro
>```

### virus classification
virus can be classified by target:
- *boot sector infector*: infects a [[filesystem in UNIX, Windows, Linux#regioni del volume|master boot record]] or boot record, and spreads when a system is booted from the disk
- *file infector*: infects files that the operating system or shell considers to be exectuable
- *macro virus*: infects files with macro or scripting code that gets interpreted by an application
- *multipartite virus*: infects files in multiple ways
they can also be classified by concealment strategy:
- *encrypted virus*: a portion of the virus creates a random encryption key and encrypts the remainder of the virus
- *stealth virus*: a form of virus explicitly designed to hide itself from detection by anti-virus software
- *polymorphic virus*: a virus that mutates with every infection (basically, are like encrypted virus but change the small decryption routine everytime, leaving the main code body constant)
- *metamorphic virus*: a virus that mutates and rewrites itself completely at each interaction and may change behaviour as well as appearance
	- the pinnacle of malware evolution, they contain a “mutation engine” that performs comprehensive (assembly)code transformations , like instruction substitution (with equivalent code), garbage code insertion, and independent code permutation
## worms
*worms* are programs that actively seek out more machines to infect. each infected machine serves as an automated launching pad for attacks on other machines
- they exploit software vulnerabilities in client or server programs
- spread through shared media or email, using macro or script code included in attachments
- unpon activation, the worm may replicate and propagate again
- usualy carries some form of payload
### replication
worms can replicate in many ways:
- *email or instant messenger facility*: the worm sends a copy of itself to other systems through email, or as an attachment via a message service
- *file sharing*: creates a copy of itself or infects a file as a virus on removable media
- *remote execution capability*: worm executes a copy of itself on another system
- *remote file access or transfer capability*: worm uses a remote file access or transfer device to copy itself from one system to the other
- *remote login capability*: worm logs onto a remote system as a user and then uses commands to copy itself from one system to the other
### target discovery
targets are discovered through:
- *scanning/fingerprinting*: the worm searches for other systems to infect
- *random*: compromised hosts probe random addresses in the IP space, using a different seed. this produces a high volume of internet traffic which may cause generalized disruption even before the actual attack is launched
- *hit-list*: the attacker comples a list of potential vulnerable machines, and each infected machine is provided with a portion of the list to scan for.
- *topological*: information contained on an infected victim machine is used to find more hosts to scan
- *local subnet*: the host uses subnet address structure to find other hosts (in the same LAN) that would otherwise be protected behind a firewall (instead, traffic moving inside a local network is much less scrutinized by perimeter firewalls)
>[!info] worm propagation model
![[Pasted image 20251127145434.png]]

>[!info] recent worm attacks
![[Pasted image 20251129133415.png]]

### mobile phone worms
>[!def] mobile code
“programs that can be shipped unchanged to a heterogeneous collection of platforms and executed with identical semantics”

the target of mobile phone worms is the smartphone, and they can completely disable the phone, delete data on the phone, or force the device to send costly messages
 - the majority of mobile phone worms use trojan apps to install themselves

>[!example] lore
> one of the first mobile phone worms was *CommWarrior*, which replicated by means of bluetooth to other phones, sent itself as an MMS file to contacts and as an autoreply to incoming text message

## attack types
### drive-by-downloads
they exploit browser and plugin vulnerabilities, and exploit such bugs to download and install malware on the systems on which users visit a webpage controlled by the attacker
- in most cases the malware does not actively propagate as a worm does
- spreads when users visit the malicious webpage
#### watering-hole attacks
a variant of the drive-by-download attack, used in highly targeted attacks, where the attacker researches which sites the victims are likely to visit, scan those sites and find vulnerabilities that allow their compromise
- attack code may even be written so that it will only infect systems belonging to the target organization and take no action for other visitors to the site, to increase the probability of the compromise to remain undetected

### malvertising
the attack places malware on websites without actually compromising them, but by paying for advertisements that are highly likely to be placed on the victim’s websites, and incorporate malware in those adverts. attackers can place these ads for as little as a few hours, when they expect victims to browse the targeted websiets
- this approach has gorwn rapidly in recent years, as they are easy to place on desired websites with few questions asked, and they are hard to track

### clickjacking (UI attack / redress attack)
vulnerabilities used by an attacker to collected a victim’s clicks/keystrokes:
- take advantages of adobe flash or js to place a button under or over a legitimate button, making it difficult for users to detect
- a typical attack uses multiple transparent/opaque layers to trick a user into clicking on a button or link on another page, when they were intending to click on the top level page
## payload types
### system corruption
this payload aims to causes real-world damage, by damaging physical equipment (using things like a *logic bomb*)
### attack agents bots
they take over another internet-attached computer, and use that computer to launch or manage attacks.
- *botnets* are collections of bots capable of acting in a coordinated matter.
they can be used in:
- DDoS attacks
- spamming
- sniffing traffic
- keylogging
- spreading new malware
- installing browser extensions
- manipulating online polls/games
### information theft
information theft can be achieved with tools such as:
- *keyloggers*, that capture keystrokes to allow attackers to monitor sensitive information. they typically use filtering mechanisms to only return information close to keywords (like “login” or “password”)
- *spyware*, that subert the compromised machine to allow monitoring of a wide range of activity on the system. it can also redirect certain web page requests to fake sites, or dynamically modify data exchanged between the browser and certain websites
- *phishing*, that exploits social engineering to leverage the user’s trust by masquerading as communication from a trusted source
	- *spear-phishing*, where recipients are carefully researched by the attacker, and the e-mail is crafted to specifically suit its recipient, often quoting a range of information to convince them of its authenticity
### stealthing
stealthing, also known as *trapdoor*, make a secret entry point into a program, allowing the attacker to gain access and bypass the security access procedures
- *maintenance hook* is a backdoor used by programmers to debug and test programs
*rootkits* are hidden programs installed on a system to maintain covert access to that system. they hide by subverting the mechanisms that monitor and report on procsses, files and registries on a computer. they are colled *rootkits* because they give *root* permissions to the attacker. they can:
- run in *user mode* or in *kernel mode* (more dangerous and more destructive)
- be *persistent* (survive a system reboot) or *memory based* (reside in the RAM)
- operate outside of the OS, by being *virtual machine-based* (the rootkit creates its own malicious layer of software) or be *hardware-based* (they infect the hardware level instruction that run before the OS even starts)

>[!info] rootkits
![[Pasted image 20251129154550.png]]

>[!example] rootkit example
![[Pasted image 20251129155445.png]]
## remote control facility
remote *C&C* (*command and control*) facilities are what distinguish a bot from a worm:
- the worm propagates itself and activates itself
- bots are initially controlled by some central facility
the typical means of implementing the remote control facility is on a *IRC* (*internet relay chat*, a protocol for instant messaging on the internet) server
- however recently more botnets use covert communication channels via protocols like HTTP
- *distributed control mechanisms* use peer-to-peer protocols to avoid a single point of failure
## countermeasures
the ideal solution to the threat of malware is *prevention*. 
one of the ways to ensure protection to malware is through *anti-virus software*, which as of now offer packages of a variety of anti-virus techniques, used in conjuction.
anti-virus software is a type of *IDS* (*intrusion detection system*), which also includes devices. IDS's can be further (commonly) categorized in *NIDS* (*network IDS*) and *HIDS* (*host-based IDS*)
if code is suspected to be malicious, it is suggested to run it in a emulated sandbox or in a virtual machine, a controlled environment where its behavior can be closely monitored without threatening the security of a real system
- the most difficult design issue with sandbox analysis is to determine how long to run each interpretation !
may 